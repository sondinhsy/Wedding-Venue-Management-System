<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.weddingapp.controller.MainController">
    <fx:define>
        <ToggleGroup fx:id="menuFilterGroup"/>
    </fx:define>
    <top>
        <HBox spacing="12" alignment="CENTER_LEFT" styleClass="top-bar">
            <padding>
                <Insets top="12" right="20" bottom="12" left="20"/>
            </padding>
            <Label text="ðŸ’’ QUáº¢N LÃ Sáº¢NH CÆ¯á»šI" styleClass="brand"/>
            <Separator orientation="VERTICAL" prefHeight="24"/>
            <Button fx:id="navDashboard" text="ðŸ“Š Tá»•ng quan" styleClass="nav-btn" onAction="#showDashboard">
                <tooltip>
                    <Tooltip text="Xem tá»•ng quan há»‡ thá»‘ng"/>
                </tooltip>
            </Button>
            <Button fx:id="navBooking" text="ðŸ“… Äáº·t chá»—" styleClass="nav-btn" onAction="#showBooking">
                <tooltip>
                    <Tooltip text="Táº¡o booking má»›i"/>
                </tooltip>
            </Button>
            <Button fx:id="navCustomers" text="ðŸ‘¥ KhÃ¡ch hÃ ng" styleClass="nav-btn" onAction="#showCustomers">
                <tooltip>
                    <Tooltip text="Quáº£n lÃ½ khÃ¡ch hÃ ng"/>
                </tooltip>
            </Button>
            <Button fx:id="navMenu" text="ðŸ½ï¸ Thá»±c Ä‘Æ¡n" styleClass="nav-btn" onAction="#showMenu">
                <tooltip>
                    <Tooltip text="Quáº£n lÃ½ thá»±c Ä‘Æ¡n"/>
                </tooltip>
            </Button>
            <Button fx:id="navReport" text="ðŸ“ˆ BÃ¡o cÃ¡o" styleClass="nav-btn" onAction="#showReports">
                <tooltip>
                    <Tooltip text="Xuáº¥t bÃ¡o cÃ¡o"/>
                </tooltip>
            </Button>
            <Pane HBox.hgrow="ALWAYS"/>
            <Button text="ðŸ”„ Táº£i láº¡i" onAction="#reloadData">
                <tooltip>
                    <Tooltip text="LÃ m má»›i dá»¯ liá»‡u"/>
                </tooltip>
            </Button>
        </HBox>
    </top>
    <left>
        <VBox spacing="8" styleClass="side-nav">
            <padding>
                <Insets top="16" right="16" bottom="16" left="16"/>
            </padding>
            <Label text="ðŸ“‹ Menu chÃ­nh" styleClass="side-header"/>
            <Button text="ðŸ“Š Dashboard" onAction="#showDashboard">
                <tooltip>
                    <Tooltip text="Tá»•ng quan há»‡ thá»‘ng"/>
                </tooltip>
            </Button>
            <Button text="ðŸ“… Äáº·t chá»—" onAction="#showBooking">
                <tooltip>
                    <Tooltip text="Táº¡o booking má»›i"/>
                </tooltip>
            </Button>
            <Button text="ðŸ‘¥ KhÃ¡ch hÃ ng" onAction="#showCustomers">
                <tooltip>
                    <Tooltip text="Quáº£n lÃ½ khÃ¡ch hÃ ng"/>
                </tooltip>
            </Button>
            <Button text="ðŸ½ï¸ Thá»±c Ä‘Æ¡n" onAction="#showMenu">
                <tooltip>
                    <Tooltip text="Quáº£n lÃ½ thá»±c Ä‘Æ¡n"/>
                </tooltip>
            </Button>
            <Button text="ðŸ“ˆ BÃ¡o cÃ¡o" onAction="#showReports">
                <tooltip>
                    <Tooltip text="Xuáº¥t bÃ¡o cÃ¡o CSV"/>
                </tooltip>
            </Button>
        </VBox>
    </left>
    <center>
        <TabPane fx:id="tabPane" tabClosingPolicy="UNAVAILABLE">
            <Tab text="ðŸ“Š Dashboard">
                <VBox spacing="16">
                    <padding>
                        <Insets top="20" right="20" bottom="20" left="20"/>
                    </padding>
                    <Label text="ðŸ“Š Tá»•ng quan nhanh" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #1e3a8a;"/>
                    <HBox spacing="16" HBox.hgrow="ALWAYS">
                        <VBox styleClass="card" HBox.hgrow="ALWAYS">
                            <Label text="ðŸ‘¥ Tá»•ng khÃ¡ch hÃ ng" style="-fx-font-size: 13px;"/>
                            <Label fx:id="customerCountLabel" styleClass="metric"/>
                        </VBox>
                        <VBox styleClass="card" HBox.hgrow="ALWAYS">
                            <Label text="ðŸ“… Sá»‘ booking" style="-fx-font-size: 13px;"/>
                            <Label fx:id="bookingCountLabel" styleClass="metric"/>
                        </VBox>
                        <VBox styleClass="card" HBox.hgrow="ALWAYS">
                            <Label text="ðŸ’° Doanh thu Æ°á»›c tÃ­nh" style="-fx-font-size: 13px;"/>
                            <Label fx:id="revenueLabel" styleClass="metric"/>
                        </VBox>
                    </HBox>
                    <HBox spacing="16" HBox.hgrow="ALWAYS">
                        <VBox styleClass="card" VBox.vgrow="ALWAYS" HBox.hgrow="ALWAYS">
                            <Label text="ðŸ›ï¸ Doanh thu theo sáº£nh" style="-fx-font-size: 14px; -fx-font-weight: 600;"/>
                            <PieChart fx:id="hallRevenueChart" prefHeight="280" VBox.vgrow="ALWAYS"/>
                        </VBox>
                        <VBox styleClass="card" VBox.vgrow="ALWAYS" HBox.hgrow="ALWAYS">
                            <Label text="ðŸ½ï¸ Doanh thu theo thá»±c Ä‘Æ¡n" style="-fx-font-size: 14px; -fx-font-weight: 600;"/>
                            <PieChart fx:id="menuRevenueChart" prefHeight="280" VBox.vgrow="ALWAYS"/>
                        </VBox>
                    </HBox>
                    <Label text="ðŸ“‹ Booking gáº§n nháº¥t" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #1e3a8a; -fx-padding: 8 0;"/>
                    <TableView fx:id="bookingTable" prefHeight="320" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colBookingCustomer" text="KhÃ¡ch hÃ ng" prefWidth="150"/>
                            <TableColumn fx:id="colBookingHall" text="Sáº£nh" prefWidth="120"/>
                            <TableColumn fx:id="colBookingDate" text="NgÃ y" prefWidth="100"/>
                            <TableColumn fx:id="colBookingTables" text="BÃ n" prefWidth="60"/>
                            <TableColumn fx:id="colBookingTotal" text="Tá»•ng tiá»n" prefWidth="150"/>
                            <TableColumn fx:id="colBookingMenu" text="Thá»±c Ä‘Æ¡n" prefWidth="220"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>
            <Tab text="ðŸ“… Äáº·t chá»—">
                <GridPane hgap="20" vgap="16">
                    <padding>
                        <Insets top="20" right="20" bottom="20" left="20"/>
                    </padding>
                    <columnConstraints>
                        <ColumnConstraints percentWidth="50" hgrow="ALWAYS"/>
                        <ColumnConstraints percentWidth="50" hgrow="ALWAYS"/>
                    </columnConstraints>
                    <children>
                        <VBox spacing="12" GridPane.columnIndex="0">
                            <Label text="ðŸ“ ThÃ´ng tin Ä‘áº·t chá»—" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #1e3a8a;"/>
                            <Label text="NgÃ y tá»• chá»©c *" style="-fx-font-size: 12px; -fx-text-fill: #64748b;"/>
                            <DatePicker fx:id="datePicker" promptText="Chá»n ngÃ y tá»• chá»©c" prefWidth="300"/>
                            <Label text="KhÃ¡ch hÃ ng *" style="-fx-font-size: 12px; -fx-text-fill: #64748b;"/>
                            <ComboBox fx:id="customerCombo" promptText="Chá»n khÃ¡ch hÃ ng" prefWidth="300"/>
                            <Label text="Sáº£nh cÆ°á»›i *" style="-fx-font-size: 12px; -fx-text-fill: #64748b;"/>
                            <ComboBox fx:id="hallCombo" promptText="Chá»n sáº£nh cÆ°á»›i" prefWidth="300"/>
                            <Label fx:id="hallInfoLabel" text="Chá»n sáº£nh Ä‘á»ƒ xem chi tiáº¿t" styleClass="hint"/>
                            <Label text="Sá»‘ bÃ n *" style="-fx-font-size: 12px; -fx-text-fill: #64748b;"/>
                            <Spinner fx:id="tableSpinner" prefWidth="300"/>
                            <Label text="Ghi chÃº" style="-fx-font-size: 12px; -fx-text-fill: #64748b;"/>
                            <TextArea fx:id="notesArea" promptText="YÃªu cáº§u Ä‘áº·c biá»‡t, ghi chÃº..." prefRowCount="4" prefWidth="300"/>
                        </VBox>
                        <VBox spacing="12" GridPane.columnIndex="1">
                            <Label text="ðŸ½ï¸ Chá»n combo / thá»±c Ä‘Æ¡n" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #1e3a8a;"/>
                            <HBox spacing="8">
                                <RadioButton fx:id="filterAllBtn" text="Táº¥t cáº£" toggleGroup="$menuFilterGroup" userData="all" styleClass="chip"/>
                                <RadioButton fx:id="filterComboBtn" text="Combo" toggleGroup="$menuFilterGroup" userData="combo" styleClass="chip"/>
                                <RadioButton fx:id="filterSingleBtn" text="MÃ³n láº»" toggleGroup="$menuFilterGroup" userData="single" styleClass="chip"/>
                            </HBox>
                            <Button text="ðŸ“– Má»Ÿ catalog mÃ³n" onAction="#openMenuCatalog" styleClass="ghost-btn" prefWidth="200">
                                <tooltip>
                                    <Tooltip text="Xem táº¥t cáº£ mÃ³n Äƒn vÃ  combo"/>
                                </tooltip>
                            </Button>
                            <Label text="Danh sÃ¡ch Ä‘Ã£ chá»n:" style="-fx-font-size: 12px; -fx-text-fill: #64748b;"/>
                            <ListView fx:id="menuList" prefHeight="200" VBox.vgrow="ALWAYS"/>
                            <VBox spacing="4" styleClass="card">
                                <Label text="ðŸ’° Tá»•ng tiá»n" style="-fx-font-size: 13px;"/>
                                <Label fx:id="totalLabel" text="0 Ä‘" styleClass="metric"/>
                            </VBox>
                            <Button text="âœ… LÆ°u booking" onAction="#handleSaveBooking" prefWidth="200" style="-fx-font-size: 14px; -fx-font-weight: bold;">
                                <tooltip>
                                    <Tooltip text="LÆ°u thÃ´ng tin Ä‘áº·t chá»—"/>
                                </tooltip>
                            </Button>
                        </VBox>
                    </children>
                </GridPane>
            </Tab>
            <Tab text="ðŸ‘¥ KhÃ¡ch hÃ ng">
                <VBox spacing="16">
                    <padding>
                        <Insets top="20" right="20" bottom="20" left="20"/>
                    </padding>
                    <Label text="âž• ThÃªm khÃ¡ch hÃ ng má»›i" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #1e3a8a;"/>
                    <HBox spacing="12" alignment="CENTER_LEFT">
                        <TextField fx:id="customerNameField" promptText="TÃªn khÃ¡ch hÃ ng *" prefWidth="250">
                            <tooltip>
                                <Tooltip text="Nháº­p tÃªn khÃ¡ch hÃ ng (báº¯t buá»™c)"/>
                            </tooltip>
                        </TextField>
                        <TextField fx:id="customerPhoneField" promptText="Sá»‘ Ä‘iá»‡n thoáº¡i" prefWidth="200">
                            <tooltip>
                                <Tooltip text="Sá»‘ Ä‘iá»‡n thoáº¡i (tÃ¹y chá»n)"/>
                            </tooltip>
                        </TextField>
                        <TextField fx:id="customerEmailField" promptText="Email" prefWidth="250">
                            <tooltip>
                                <Tooltip text="Email (tÃ¹y chá»n)"/>
                            </tooltip>
                        </TextField>
                        <Button text="âž• ThÃªm" onAction="#handleAddCustomer" prefWidth="120">
                            <tooltip>
                                <Tooltip text="ThÃªm khÃ¡ch hÃ ng má»›i vÃ o há»‡ thá»‘ng"/>
                            </tooltip>
                        </Button>
                    </HBox>
                    <Label text="ðŸ“‹ Danh sÃ¡ch khÃ¡ch hÃ ng" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #1e3a8a; -fx-padding: 8 0;"/>
                    <TableView fx:id="customerTable" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colCustomerName" text="TÃªn"/>
                            <TableColumn fx:id="colCustomerPhone" text="Äiá»‡n thoáº¡i"/>
                            <TableColumn fx:id="colCustomerEmail" text="Email"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>
            <Tab text="ðŸ½ï¸ Thá»±c Ä‘Æ¡n">
                <VBox spacing="16">
                    <padding>
                        <Insets top="20" right="20" bottom="20" left="20"/>
                    </padding>
                    <Label text="âž• ThÃªm mÃ³n / combo má»›i" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #1e3a8a;"/>
                    <HBox spacing="12" alignment="CENTER_LEFT">
                        <TextField fx:id="menuTitleField" promptText="TÃªn mÃ³n / combo *" prefWidth="300">
                            <tooltip>
                                <Tooltip text="Nháº­p tÃªn mÃ³n hoáº·c combo (báº¯t buá»™c)"/>
                            </tooltip>
                        </TextField>
                        <TextField fx:id="menuPriceField" promptText="GiÃ¡ (VNÄ) *" prefWidth="200">
                            <tooltip>
                                <Tooltip text="Nháº­p giÃ¡ tiá»n (báº¯t buá»™c)"/>
                            </tooltip>
                        </TextField>
                        <Button text="âž• ThÃªm" onAction="#handleAddMenu" prefWidth="120">
                            <tooltip>
                                <Tooltip text="ThÃªm mÃ³n má»›i vÃ o thá»±c Ä‘Æ¡n"/>
                            </tooltip>
                        </Button>
                    </HBox>
                    <Label text="ðŸ“‹ Danh sÃ¡ch thá»±c Ä‘Æ¡n" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #1e3a8a; -fx-padding: 8 0;"/>
                    <TableView fx:id="menuTable" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colMenuTitle" text="TÃªn"/>
                            <TableColumn fx:id="colMenuPrice" text="GiÃ¡ (VNÄ)" prefWidth="150"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>
            <Tab text="ðŸ“ˆ BÃ¡o cÃ¡o">
                <VBox spacing="16">
                    <padding>
                        <Insets top="20" right="20" bottom="20" left="20"/>
                    </padding>
                    <Label text="ðŸ“Š Xuáº¥t bÃ¡o cÃ¡o CSV" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #1e3a8a;"/>
                    <Label text="Xuáº¥t táº¥t cáº£ booking vÃ  thá»±c Ä‘Æ¡n Ä‘Ã£ chá»n ra file CSV Ä‘á»ƒ phÃ¢n tÃ­ch" styleClass="hint"/>
                    <Button text="ðŸ“¥ Xuáº¥t CSV" onAction="#handleExportCsv" prefWidth="200" style="-fx-font-size: 14px; -fx-font-weight: bold;">
                        <tooltip>
                            <Tooltip text="Xuáº¥t dá»¯ liá»‡u booking ra file CSV"/>
                        </tooltip>
                    </Button>
                    <Label text="Tráº¡ng thÃ¡i:" style="-fx-font-size: 13px; -fx-text-fill: #64748b;"/>
                    <TextArea fx:id="exportStatusArea" editable="false" prefRowCount="10" styleClass="export-status" VBox.vgrow="ALWAYS"/>
                </VBox>
            </Tab>
        </TabPane>
    </center>
</BorderPane>